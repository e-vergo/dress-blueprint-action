/* ========== Theme Blue Base (from plasTeX) ========== */
@charset "UTF-8";
a,abbr,acronym,address,applet,article,aside,audio,b,big,blockquote,body,canvas,caption,center,cite,code,dd,del,details,dfn,div,dl,dt,em,embed,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,html,i,iframe,img,ins,kbd,label,legend,li,mark,menu,nav,object,ol,output,p,pre,q,ruby,s,samp,section,small,span,strike,strong,sub,summary,sup,table,tbody,td,tfoot,th,thead,time,tr,tt,u,ul,var,video{font:inherit;font-size:100%;margin:0;padding:0;border:0}
article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}
body{line-height:1;overflow-x:hidden;background:#f4f4f4}
ol,ul{list-style:none}
blockquote,q{quotes:none}
blockquote:after,blockquote:before,q:after,q:before{content:"";content:none}
table{border-spacing:0;border-collapse:collapse}
.clear:after{font-size:0;display:block;visibility:hidden;clear:both;height:0;content:" "}
.clear{display:inline-block}
* html .clear{height:1%}
.clear{display:block}
*{box-sizing:border-box}
hr{clear:both;border:none;outline:none}
em{font-style:italic}
a{text-decoration:underline}
ul{list-style:disc}
ol{list-style:decimal}
ol,ul{font-size:14px;padding:0 0 0 33px}
ol li,ul li{margin:0}
blockquote{padding:0 15px 0 40px}
table{font-size:13px;width:100%;margin:20px 0;background:#fff}
table th{font-size:16px;font-weight:700}
table tr td{padding:7px}
::selection{color:#fff;background:#000}
::-moz-selection{color:#fff;background:#000}
body{height:100vh;margin:0;flex-direction:column;color:#0a0a14;background-color:#e8e8e8}
body,div.wrapper{display:flex;overflow:hidden}
div.wrapper{flex-grow:1}
div.content-wrapper{max-width:1800px}
@media (min-width:1024px){div.content-wrapper{margin-left:auto;margin-right:auto}}
div.content{flex-grow:1;display:flex;flex-direction:column;overflow:auto;padding:.5rem;margin-bottom:2.5rem}
@media (min-width:1024px){div.content{padding:1rem;margin-bottom:0}}
div.centered{display:flex;flex-direction:column;flex-wrap:wrap;align-items:center;justify-content:space-around;min-width:100%;margin:0 auto}
div.flushleft,div.raggedright{display:flex;justify-content:flex-start}
div.flushright,div.raggedbottom,div.raggedleft{display:flex;justify-content:flex-end}
div.raggedbottom{flex-direction:column}
div.content{line-height:1.4rem}
div.content>p{margin:2.1rem 0}
li>p{margin:.28rem 0}
.icon{display:inline-block;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:1rem;height:1rem;stroke-width:0;stroke:currentColor;fill:currentColor}
h1,h2,h3,h4,h5,h6{font-family:Lucida Grande,Arial,Helvetica,sans-serif}
h1{font-size:2rem;line-height:2rem;margin:1rem 0}
h1,h2{color:#0f2f48}
h2{font-size:1.5rem;margin:.8rem 0}
h3,h4{margin:.67rem 0;color:#0f2f48}
h3,h4,p{font-size:1rem}
p{margin:.5rem 0}
.titlepage{text-align:center}
.titlepage h1{font-weight:400}
b,strong{font-weight:700}
dfn{font-style:italic}
code,kbd,pre,samp{font-family:monospace,serif;font-size:1rem}
pre{white-space:pre-wrap}
q{quotes:""" """ "'" "'"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5rem}
sub{bottom:-.25rem}
.mdseries,.textmf{font-weight:400}
.bfseries,.textbf{font-weight:700}
.rmfamily,.textrm{font-family:serif}
.sffamily,.textsf{font-family:sans-serif}
.texttt,.ttfamily{font-family:monospace}
.textup,.upshape{text-transform:uppercase}
.itshape,.textit{font-style:italic}
.slshape,.textsl{font-style:oblique}
.scshape,.textsc{font-variant:small-caps}
small.tiny{font-size:x-small}
small.scriptsize{font-size:smaller}
small.footnotesize,small.small{font-size:small}
.normalsize{font-size:normal}
big.large{font-size:large}
big.xlarge,big.xxlarge{font-size:x-large}
big.huge,big.xhuge{font-size:xx-large}
.rm{font-family:serif;font-style:normal;font-weight:400}
.cal,.it{font-style:italic}
.cal,.it,.sl{font-family:serif;font-weight:400}
.sl{font-style:oblique}
.bf{font-family:serif;font-weight:700}
.bf,.tt{font-style:normal}
.tt{font-family:monospace;font-weight:400}
.underbar{text-decoration:underline}
.fbox,.framebox{border:1px solid #000;padding:1px 3px}
.quotation p,.quote p,.verse p{margin-top:0;margin-bottom:.5em}
hr{color:#000}
dd{margin-left:3rem}
dd p{padding:0;margin:0 0 1rem}
ul.breadcrumbs{margin:0;padding:0;list-style:none;font-size:small}
ul.breadcrumbs li{display:inline}
ul.breadcrumbs a{text-decoration:none;color:#396282}
li.crumb:after{content:" / "}
div.equation{display:flex;align-items:center;margin:1rem}
div.equation span.equation_label{margin-right:1rem}
div.equation span.equation_label:before{content:"("}
div.equation span.equation_label:after{content:")"}
div.equation div.equation_content{margin:auto}
figure{display:flex;flex-direction:column;vertical-align:bottom;overflow:auto}
figure img{display:block;margin:0 auto}
figcaption{display:block;text-align:center;margin-bottom:.1rem}
span.caption_ref,span.caption_title,span.subcaption{font-weight:700}
span.caption_ref:after{content:":"}
span.subref:after{content:")"}
footer#footnotes{clear:both;padding-top:1rem;padding-left:1rem;border-color:gray;border-top:1px solid}
footer#footnotes h1{font-size:1.5rem;margin:0;margin-bottom:.5rem;color:#000}
a.footnote{text-decoration:none}
a.footnote sup:after{content:"]"}
a.footnote sup:before{content:"["}
body>header{background:linear-gradient(180deg,#6696bb 0,#396282);color:#fff;display:flex;align-items:center;padding:.5rem}
#toc-toggle{font-size:1.75rem;margin-right:.5rem;cursor:pointer}
h1#doc_title{color:#fff;font-size:1.5rem;margin:auto}
#doc_title a,#doc_title a:visited{text-decoration:none;color:#fff}
.theindex li{list-style-type:none}
nav.index-groups{margin-bottom:1rem}
a[class^=index-group]{text-decoration:none}
a.index-group:after{content:" |"}
section.theindex{display:flex;flex-direction:row;flex-wrap:wrap;margin-top:1rem}
section.theindex h2{min-width:100%;margin:1rem 0 .5rem}
ul.index-column{min-width:100%}
@media (min-width:1024px){ul.index-column{min-width:auto}}
nav.prev_up_next a.index{font-size:small;padding-left:.5rem;padding-right:.5rem}
dl.description dt{font-weight:700}
table.list{margin-left:15px;margin-top:1em;margin-bottom:1em}
table.list td{padding-right:5px}
div.displaymath{overflow:auto}
a.eqref:before{content:"("}
a.eqref:after{content:")"}
nav.prev_up_next{position:fixed;z-index:1;right:0;bottom:0;display:flex;height:2.5rem;background:linear-gradient(180deg,#6696bb 0,#396282)}
nav.prev_up_next a{font-size:150%;margin:auto;padding:.5rem 1rem;text-decoration:none;color:#fff;text-shadow:1px 2px 0 rgba(0,0,0,.8)}
hspace,vspace{margin:0;padding:0}
div.bigskip{margin-bottom:4rem}
div.medskip{margin:0;padding:0;margin-bottom:2rem}
div.bigskip{margin:0;padding:0;margin-bottom:1rem}
.tabular{border-collapse:collapse;color:#0a0a14;background-color:#e8e8e8;width:auto}
.tabular td,.tabular th{vertical-align:baseline;text-align:left;padding:.3em .6em;empty-cells:show}
td p:first-child,th p:first-child{margin-top:0;margin-bottom:0}
td p,th p{margin-top:1em;margin-bottom:0}
@keyframes a{0%{background-color:#c2c2c2}to{background-color:#e8e8e8}}
div[class$=_thmwrapper]{margin-top:1rem}
div[class$=_thmwrapper]:target{animation:a 1s ease}
div[class$=_thmheading]{display:flex;font-weight:700;line-height:150%}
span[class$=_thmtitle]:before{content:"("}
span[class$=_thmtitle]:after{content:")"}
div[class$=_thmcontent]{font-weight:400;margin-left:1rem;padding-top:.14rem;padding-left:1rem}
span[class$=_thmlabel]{margin-left:.5rem;margin-right:.5rem}
div[class$=proof_heading]{font-weight:700;line-height:120%;cursor:pointer}
div.proof_content{font-weight:400;margin-left:1rem;padding-top:.5rem;padding-left:1rem}
span.expand-proof{font-size:80%}
div.hilite{animation:a 1s ease}
span.qed{float:right}
button.modal{border:none;text-align:center;text-decoration:none;background:transparent;cursor:pointer;padding:0}
div.modal-container{position:fixed;z-index:2;top:0;left:0;display:none;width:100%;height:100%}
div.modal-content{font-weight:400;overflow:auto;margin:auto;vertical-align:middle;border:1px solid #497da5;border-radius:5px;background-color:#fff;box-shadow:0 4px 8px 0 rgba(0,0,0,.2),0 6px 20px 0 rgba(0,0,0,.19)}
div.modal-content header{position:relative;background:linear-gradient(180deg,#6696bb 0,#396282);color:#fff;text-shadow:1px 2px 0 rgba(0,0,0,.8);display:flex;flex-direction:row;min-height:1rem;min-width:100%;text-align:center;vertical-align:middle;padding:0 .5rem;justify-content:space-between}
div.modal-content header button.closebtn{font-size:120%;font-weight:700;background:Transparent;border:none;margin:auto 0;padding-right:.3rem;text-decoration:none;color:#fff;cursor:pointer}
div.modal-content header h1{font-size:120%;margin:auto 0;padding:.2rem;color:#fff}
div.modal-content a{text-decoration:none}
div.modal-content ul{padding:1rem;list-style:none}
div.modal-content li{padding-left:.5rem}
a.icon{text-decoration:none;color:#0a0a14;border:none;background-color:Transparent}
div[class$=_thmheading]:hover div.thm_header_hidden_extras{display:inline-block}
div.thm_header_hidden_extras{display:none}
ul.quizz{display:flex;flex-direction:column;list-style:circle!important}
ul.quizz li{display:flex;padding:.5rem;flex-direction:row;min-width:100%;min-height:3rem;flex-grow:1;align-items:center;justify-content:space-between}
ul.quizz li.active-qright{background-color:green}
ul.quizz li.active-qwrong{background-color:red}
ul.quizz svg.icon{display:none;padding-right:.5rem;width:2rem;height:2rem}
.tikzcd{overflow:auto}
.tikzcd,.tikzpicture{display:block;margin:.5rem auto}
.local_toc ul{padding-left:1rem;list-style:none}
.local_toc ul a{text-decoration:none;color:#0a0a14}
.local_toc ul li{padding:.2rem 0}
nav.toc{flex-shrink:0;display:none;width:100%;overflow-x:hidden;overflow-y:auto;flex-direction:column;margin-right:1rem;padding:0;padding-right:1rem;transition:left .5s ease;background-color:#6696bb;border-right:none}
@media (min-width:1024px){nav.toc{display:flex;max-width:25ch}}
nav.active{width:100%}
.toc ul{min-width:100%;padding-left:0;list-style:none}
.toc ul a{display:inline-block;max-width:90%;padding-top:.5rem;padding-right:.5rem;padding-bottom:.5rem;transition:all .1s ease;text-align:left;text-decoration:none;font-size:1.125rem;color:#fff;text-shadow:2px 2px 2px rgba(0,0,0,.8);flex-grow:1}
.toc ul a:hover{transition:all .2s ease;background:#497da5}
.toc ul li{display:flex;min-width:100%;align-items:center;flex-wrap:wrap;justify-content:space-between;background-color:#6696bb}
.toc ul li.current{background-color:#89aecb;font-weight:400}
.sub-toc-0 a{padding-left:.8rem}
.sub-toc-1 a{padding-left:1.6rem}
.sub-toc-2 a{padding-left:2.4rem}
.sub-toc-3 a{padding-left:3.2rem}
.sub-toc-4 a{padding-left:4rem}
ul.sub-toc-1,ul.sub-toc-2,ul.sub-toc-3,ul.sub-toc-4{display:none}
span.expand-toc{min-width:.7rem;width:.8rem;height:.8rem;padding:0;padding-right:.5rem;font-size:125%;cursor:pointer;text-align:center;color:#fff;background-color:Transparent}
svg.close-toc{min-width:1.3rem;min-height:1.3rem;margin:.5rem;margin-left:auto;display:none;cursor:pointer;text-align:center;color:#fff;background-color:Transparent}
nav.active svg.close-toc{display:inline-block}
ul.active{display:block}
code.verb{font-family:monospace;font-style:normal;font-weight:400}
pre.verbatim{margin:1rem 2rem;background-color:#dbdbdb;padding:.5rem}

/* ========== Side-by-side Layout (from leanblueprint) ========== */
a.github_link {
  font-weight: normal;
  font-size: 90%;
  text-decoration: none;
  color: inherit;
}

.sbs-container {
  display: grid;
  grid-template-columns: minmax(75ch, 75ch) minmax(0, 1fr);
  gap: 3rem;
  align-items: start;
  margin-bottom: 3rem;
  margin-left: 3rem;
}

.sbs-latex-column {
  width: 75ch;
  max-width: 75ch;
  overflow-wrap: break-word;
  word-wrap: break-word;
}

.sbs-lean-column {
  min-width: 0;
  overflow-wrap: break-word;
  word-wrap: break-word;
  overflow-x: auto;
  position: relative;
}

.sbs-lean-column pre.lean-code {
  margin: 0;
  padding: 0;
  background: transparent;
  font-family: 'JetBrains Mono', 'Fira Code', monospace;
  font-size: 0.85rem;
  line-height: 1.5;
  white-space: pre-wrap;
  word-wrap: break-word;
}

.sbs-lean-column pre.lean-code code {
  font-family: inherit;
}

.lean-github-hover {
  position: absolute;
  top: 0;
  right: 0;
  opacity: 0;
  transition: opacity 0.2s;
  padding: 0.25rem;
  color: #586069;
}

.lean-github-hover:hover {
  color: #0366d6;
}

.sbs-lean-column:hover .lean-github-hover {
  opacity: 1;
}

.lean-proof-body {
  display: none;
}

.thm_body_extras {
  display: none;
}

.proof_wrapper.proof_inline {
  display: block !important;
}

.proof_wrapper.proof_inline .proof_content {
  display: none;
}

/* ========== Lean Syntax Highlighting ========== */
.lean-keyword, .hl.lean .keyword, .keyword.token { color: #0000ff; }
.lean-const, .hl.lean .const, .const.token { color: #AF8700; }
.lean-const.lean-def, .hl.lean .const[data-defining="true"], .const.token[data-defining="true"] {
  font-weight: bold;
  text-decoration: underline;
  text-decoration-style: dotted;
  text-underline-offset: 2px;
}
.lean-var, .hl.lean .var, .var.token { color: #0070C1; }
.lean-string, .hl.lean .literal.string, .literal.string.token { color: #a31515; }
.lean-option, .hl.lean .option, .option.token { color: #795e26; }
.lean-docstring, .hl.lean .doc-comment, .doc-comment.token { color: #008000; font-style: italic; }
.lean-sort, .hl.lean .sort, .sort.token { color: #267f99; }
.lean-level, .hl.lean .level-var, .hl.lean .level-const, .hl.lean .level-op,
.level-var.token, .level-const.token, .level-op.token { color: #098658; }
.lean-module, .hl.lean .module-name, .module-name.token { color: #795e26; }
.lean-expr, .hl.lean .typed, .typed.token { color: inherit; }
.lean-text, .hl.lean .unknown, .hl.lean .inter-text, .unknown.token, .inter-text { color: inherit; }
.lean-sorry, .sorry.token { color: #ff0000; background-color: #ffeaea; font-weight: bold; }

.lean-number { color: #098658; }
.lean-operator { color: #000000; }
.lean-comment { color: #008000; font-style: italic; }

/* Rainbow brackets */
.lean-bracket-1 { color: #d000ff; }
.lean-bracket-2 { color: #5126ff; }
.lean-bracket-3 { color: #0184BC; }
.lean-bracket-4 { color: #4078F2; }
.lean-bracket-5 { color: #50A14F; }
.lean-bracket-6 { color: #E45649; }

/* Message spans */
.lean-span, .hl.lean .has-info { }
.lean-error, .hl.lean .has-info.error { text-decoration: wavy underline #c82829; }
.lean-warning, .hl.lean .has-info.warning { text-decoration: wavy underline #eab700; }
.lean-info, .hl.lean .has-info.information { text-decoration: underline dotted #4271ae; }

/* Token binding highlight */
.hl.lean .token.binding-hl {
  background-color: rgba(255, 255, 0, 0.3);
  border-radius: 2px;
}

/* Hover info */
.hl.lean .hover-info {
  display: block;
  padding: 8px;
  font-family: 'JetBrains Mono', 'Fira Code', monospace;
  font-size: 0.9em;
}

.hl.lean .hover-info code { font-family: inherit; }

.hl.lean .sep {
  display: block;
  height: 1px;
  background-color: #ccc;
  margin: 8px 0;
}

.hl.lean .docstring {
  color: #666;
  font-style: italic;
  margin-top: 8px;
}

.hl.lean .docstring p { margin: 0.5em 0; }

.hl.lean .docstring code {
  background-color: rgba(0, 0, 0, 0.05);
  padding: 0 4px;
  border-radius: 2px;
}

/* Extra doc links */
.extra-doc-links {
  list-style-type: none;
  margin-left: 0;
  padding: 0;
  margin-top: 8px;
  border-top: 1px solid #ccc;
  padding-top: 8px;
}

.extra-doc-links > li { display: inline-block; }

.extra-doc-links > li:not(:last-child)::after {
  content: '|';
  display: inline-block;
  margin: 0 0.25em;
  color: #999;
}

/* ========== Tippy.js Themes ========== */
[data-tippy-root] { z-index: 99999 !important; }

.tippy-box {
  -webkit-text-size-adjust: 100%;
  text-size-adjust: 100%;
}

.tippy-box[data-theme~='lean'] {
  background-color: #f5f5f5;
  color: black;
  border: 1px solid #333;
  border-radius: 4px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
}

.tippy-box[data-theme~='lean'] .tippy-content {
  padding: 8px 12px;
  font-family: 'JetBrains Mono', 'Fira Code', monospace;
  font-size: 0.85em;
}

.tippy-box[data-theme~='lean'][data-placement^='top'] > .tippy-arrow::before { border-top-color: #f5f5f5; }
.tippy-box[data-theme~='lean'][data-placement^='bottom'] > .tippy-arrow::before { border-bottom-color: #f5f5f5; }
.tippy-box[data-theme~='lean'][data-placement^='left'] > .tippy-arrow::before { border-left-color: #f5f5f5; }
.tippy-box[data-theme~='lean'][data-placement^='right'] > .tippy-arrow::before { border-right-color: #f5f5f5; }

.tippy-box[data-theme~='warning'] {
  background-color: #fff8e6;
  color: black;
  border: 2px solid #f0ad4e;
  border-radius: 4px;
}

.tippy-box[data-theme~='warning'][data-placement^='top'] > .tippy-arrow::before { border-top-color: #fff8e6; }
.tippy-box[data-theme~='warning'][data-placement^='bottom'] > .tippy-arrow::before { border-bottom-color: #fff8e6; }

.tippy-box[data-theme~='error'] {
  background-color: #fff0f0;
  color: black;
  border: 2px solid #d9534f;
  border-radius: 4px;
}

.tippy-box[data-theme~='error'][data-placement^='top'] > .tippy-arrow::before { border-top-color: #fff0f0; }
.tippy-box[data-theme~='error'][data-placement^='bottom'] > .tippy-arrow::before { border-bottom-color: #fff0f0; }

.tippy-box[data-theme~='info'] {
  background-color: #f0f8ff;
  color: black;
  border: 2px solid #5bc0de;
  border-radius: 4px;
}

.tippy-box[data-theme~='info'][data-placement^='top'] > .tippy-arrow::before { border-top-color: #f0f8ff; }
.tippy-box[data-theme~='info'][data-placement^='bottom'] > .tippy-arrow::before { border-bottom-color: #f0f8ff; }

.tippy-box[data-theme~='tactic'] {
  background-color: white;
  color: black;
  border: 1px solid #333;
  border-radius: 4px;
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.2);
}

.tippy-box[data-theme~='tactic'] .tippy-content { padding: 12px; }

.tippy-box[data-theme~='tactic'][data-placement^='top'] > .tippy-arrow::before { border-top-color: white; }
.tippy-box[data-theme~='tactic'][data-placement^='bottom'] > .tippy-arrow::before { border-bottom-color: white; }
.tippy-box[data-theme~='tactic'][data-placement^='left'] > .tippy-arrow::before { border-left-color: white; }
.tippy-box[data-theme~='tactic'][data-placement^='right'] > .tippy-arrow::before { border-right-color: white; }

/* Tactic state display - smooth animation like proof toggle */
/* Override Verso's display-based toggle with max-height animation */
.hl.lean input.tactic-toggle { display: none; }
.hl.lean .tactic-state {
  display: block !important;  /* Override Verso's display:none */
  max-height: 0;
  overflow: hidden;
  opacity: 0;
  transition: max-height 0.3s ease-out, opacity 0.3s ease-out, padding 0.3s ease-out, margin 0.3s ease-out;
  margin-top: 0;
  padding: 0 8px;
  background-color: #f9f9f9;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.hl.lean input.tactic-toggle:checked ~ .tactic-state {
  display: block !important;  /* Override Verso's display:inline-block */
  max-height: 500px;
  opacity: 1;
  margin-top: 8px;
  padding: 8px;
}

.hl.lean .tactic > label { cursor: pointer; }

.hl.lean .tactic::before {
  content: '\25CF';
  color: #4271ae;
  font-size: 0.6em;
  vertical-align: super;
  margin-right: 2px;
  opacity: 0.5;
}

.hl.lean .tactic:hover::before { opacity: 1; }

.hl.lean .goal {
  margin-bottom: 12px;
  padding-bottom: 8px;
  border-bottom: 1px solid #eee;
}

.hl.lean .goal:last-child {
  margin-bottom: 0;
  padding-bottom: 0;
  border-bottom: none;
}

.hl.lean .goal-name {
  color: #666;
  font-style: italic;
  margin-bottom: 4px;
}

.hl.lean .hypotheses {
  display: table;
  border-collapse: collapse;
  margin-bottom: 8px;
}

.hl.lean .hypotheses .hypothesis { display: table-row; }

.hl.lean .hypotheses .name {
  display: table-cell;
  padding-right: 8px;
  text-align: right;
  color: #c82829;
  font-family: 'JetBrains Mono', 'Fira Code', monospace;
}

.hl.lean .hypotheses .colon {
  display: table-cell;
  padding-right: 8px;
  color: #666;
}

.hl.lean .hypotheses .type {
  display: table-cell;
  font-family: 'JetBrains Mono', 'Fira Code', monospace;
}

.hl.lean .conclusion { margin-top: 8px; }

.hl.lean .conclusion .goal-prefix {
  color: #666;
  margin-right: 4px;
}

.hl.lean .conclusion .type {
  font-family: 'JetBrains Mono', 'Fira Code', monospace;
}

/* ========== Multi-page Navigation ========== */
.prev-next-nav {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 3rem;
  padding-top: 1.5rem;
  border-top: 1px solid #e5e7eb;
}

.prev-next-nav a {
  color: #396282;
  text-decoration: none;
  padding: 0.5rem 1rem;
  border: 1px solid #e5e7eb;
  border-radius: 4px;
  transition: background-color 0.2s;
}

.prev-next-nav a:hover {
  background-color: #f3f4f6;
}

.prev-next-nav a.prev {
  margin-right: auto;
}

.prev-next-nav a.next {
  margin-left: auto;
}

/* Chapter list on index page */
.chapter-list {
  margin: 2rem 0;
}

.chapter-list h2 {
  margin-bottom: 1rem;
  color: #0f2f48;
}

.chapter-index {
  padding-left: 1.5rem;
}

.chapter-index li {
  margin: 0.5rem 0;
  line-height: 1.6;
}

.chapter-index a {
  color: #396282;
  text-decoration: none;
}

.chapter-index a:hover {
  text-decoration: underline;
}

/* Chapter page styling */
.chapter-page {
  margin: 1rem 0;
}

.chapter-title {
  color: #0f2f48;
  margin-bottom: 1.5rem;
}

.chapter-nodes, .section-nodes {
  margin: 1rem 0;
}

.section {
  margin: 2rem 0;
  padding-top: 1rem;
  border-top: 1px solid #e5e7eb;
}

.section-title {
  color: #0f2f48;
  margin-bottom: 1rem;
}

/* Active sidebar item highlighting */
nav.toc li.active a {
  background-color: #497da5;
  font-weight: bold;
}

/* ========== Blueprint Theme Styles (from Theme.lean) ========== */
/* CSS variables for theming */
:root {
  --bp-primary: #2563eb;
  --bp-success: #16a34a;
  --bp-warning: #ca8a04;
  --bp-danger: #dc2626;
  --bp-muted: #6b7280;
  --bp-bg: #ffffff;
  --bp-bg-alt: #f9fafb;
  --bp-border: #e5e7eb;
  --bp-text: #1f2937;
  --bp-text-muted: #6b7280;
  --bp-font-sans: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  --bp-font-mono: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Monaco, Consolas, monospace;
  --bp-max-width: 1200px;
  --bp-spacing: 1.5rem;
}

@media (prefers-color-scheme: dark) {
  :root {
    --bp-bg: #111827;
    --bp-bg-alt: #1f2937;
    --bp-border: #374151;
    --bp-text: #f9fafb;
    --bp-text-muted: #9ca3af;
  }
}

/* Progress Section */
.progress-section {
  margin: 2rem 0;
  padding: 1rem 0;
}

.progress-bar {
  height: 8px;
  background: var(--bp-border);
  border-radius: 4px;
  overflow: hidden;
  margin: 0.75rem 0;
}

.progress-fill {
  height: 100%;
  background: var(--bp-primary);
  transition: width 0.3s ease;
}

.progress-label {
  font-size: 0.8125rem;
  color: var(--bp-text-muted);
  text-align: right;
  margin-top: 0.25rem;
}

.progress-stats {
  display: flex;
  flex-wrap: wrap;
  gap: 0.25rem 1rem;
  align-items: center;
  font-size: 0.8125rem;
  color: var(--bp-text-muted);
}

.stat {
  display: inline-flex;
  align-items: center;
  gap: 0.375rem;
}

.stat::before {
  content: '';
  display: inline-block;
  width: 8px;
  height: 8px;
  border-radius: 2px;
  flex-shrink: 0;
}

.stat.proved::before { background: var(--bp-success); }
.stat.mathlib::before { background: var(--bp-primary); }
.stat.stated::before { background: var(--bp-warning); }
.stat.not-ready::before { background: var(--bp-danger); }
.stat.total::before { background: var(--bp-text-muted); }

.stat-separator {
  color: var(--bp-border);
  margin: 0 0.25rem;
}

/* Node Styles */
.node {
  border: 1px solid var(--bp-border);
  border-radius: 8px;
  margin: 1.5rem 0;
  overflow: hidden;
}

.node-header {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  padding: 1rem;
  background: var(--bp-bg-alt);
  border-bottom: 1px solid var(--bp-border);
}

.node-env {
  font-weight: 600;
  text-transform: capitalize;
}

.node-title {
  flex: 1;
}

.node-status {
  width: 12px;
  height: 12px;
  border-radius: 50%;
}

.status-proved .node-status, .node-proved .node-status { background: var(--bp-success); }
.status-mathlib-ok .node-status, .node-mathlib-ok .node-status { background: var(--bp-primary); }
.status-stated .node-status, .node-stated .node-status { background: var(--bp-warning); }
.status-not-ready .node-status, .node-not-ready .node-status { background: var(--bp-danger); }

.node-content {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1rem;
  padding: 1rem;
}

@media (max-width: 768px) {
  .node-content {
    grid-template-columns: 1fr;
  }
}

.node-statement, .node-proof {
  padding: 1rem;
  background: var(--bp-bg-alt);
  border-radius: 4px;
}

.node-statement h4, .node-proof h4 {
  margin: 0 0 0.75rem 0;
  font-size: 0.875rem;
  color: var(--bp-text-muted);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.node-footer {
  padding: 0.75rem 1rem;
  border-top: 1px solid var(--bp-border);
  font-size: 0.875rem;
  color: var(--bp-text-muted);
}

.node-decls, .node-deps {
  display: inline;
}

.node-decls + .node-deps::before {
  content: " | ";
  margin: 0 0.5rem;
}

.decl-link, .dep-link {
  color: var(--bp-primary);
  text-decoration: none;
}

.decl-link:hover, .dep-link:hover {
  text-decoration: underline;
}

/* Index Page */
.index-header {
  text-align: center;
  margin-bottom: 2rem;
}

.index-header h1 {
  margin-bottom: 1rem;
}

.github-link, .docs-link {
  margin: 0 0.5rem;
  color: var(--bp-primary);
}

/* Graph Section */
.graph-section {
  margin: 2rem 0;
}

.dep-graph-container {
  position: relative;
  width: 100%;
  border: 1px solid var(--bp-border);
  border-radius: 8px;
  background: var(--bp-bg-alt);
  overflow: hidden;
}

.dep-graph-toolbar {
  position: absolute;
  top: 0.5rem;
  right: 0.5rem;
  z-index: 10;
  display: flex;
  gap: 0.25rem;
  background: var(--bp-bg);
  border: 1px solid var(--bp-border);
  border-radius: 4px;
  padding: 0.25rem;
}

.dep-graph-toolbar button {
  padding: 0.25rem 0.5rem;
  border: 1px solid var(--bp-border);
  border-radius: 3px;
  background: var(--bp-bg);
  color: var(--bp-text);
  cursor: pointer;
  font-size: 0.875rem;
  line-height: 1;
  transition: background 0.15s ease;
}

.dep-graph-toolbar button:hover {
  background: var(--bp-bg-alt);
}

.dep-graph-toolbar button:active {
  background: var(--bp-border);
}

/* Fit button expands to fill available width */
.dep-graph-toolbar button#graph-fit {
  flex: 1;
}

.dep-graph-viewport {
  width: 100%;
  min-height: 200px;
  max-height: 600px;
  overflow: auto;
  cursor: grab;
  background: #ffffff;  /* Explicit white to match SVG background */
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -webkit-touch-callout: none;
  -webkit-tap-highlight-color: transparent;
  touch-action: none;
}

.dep-graph-viewport:active {
  cursor: grabbing;
}

.dep-graph-svg {
  transform-origin: 0 0;
  will-change: transform;
  display: inline-block;  /* Shrink-wrap to SVG size */
  user-select: none;
  -webkit-user-select: none;
}

.dep-graph-svg.dragging {
  transition: none !important;
}

.dep-graph-svg svg {
  display: block;
  background: #ffffff;  /* Ensure SVG has white background */
}

.dep-graph-svg text,
.dep-graph-svg tspan {
  pointer-events: none;  /* Prevent text from interfering with drag */
  user-select: none;
}

.dep-graph-placeholder {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 200px;
  color: var(--bp-text-muted);
  font-style: italic;
}

/* Node highlight animation */
.node-highlight {
  animation: node-flash 2s ease-out;
}

@keyframes node-flash {
  0%, 100% { box-shadow: none; }
  20%, 80% { box-shadow: 0 0 0 4px var(--bp-primary); }
}

/* Node Lists */
.node-lists {
  margin: 2rem 0;
}

.node-list h3 {
  margin-bottom: 1rem;
}

.node-index {
  list-style: none;
  padding: 0;
  margin: 0;
}

.node-index li {
  padding: 0.5rem 0;
  border-bottom: 1px solid var(--bp-border);
}

.node-index a {
  color: var(--bp-text);
  text-decoration: none;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.node-index a:hover {
  color: var(--bp-primary);
}

/* Lean Code Highlighting */
pre.lean-code {
  font-family: var(--bp-font-mono);
  font-size: 0.875rem;
  padding: 1rem;
  overflow-x: auto;
  background: var(--bp-bg);
}

/* Math rendering */
.math.inline { }
.math.display {
  overflow-x: auto;
  padding: 1rem 0;
}

/* ========== Full-page Graph Styles ========== */
.dep-graph-page {
  height: 100vh;
  display: flex;
  flex-direction: column;
}

.dep-graph-page .wrapper {
  flex: 1;
  display: flex;
  overflow: hidden;
}

.dep-graph-page .content {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  padding: 1rem;
}

.dep-graph-fullpage {
  flex: 1;
  display: flex;
  flex-direction: column;
}

.dep-graph-fullpage .dep-graph-viewport {
  flex: 1;
  height: 90vh !important;
  max-height: none;
}

/* Graph header with link to full page */
.graph-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
}

.graph-header h2 {
  margin: 0;
}

.graph-fullpage-link {
  color: var(--bp-primary);
  text-decoration: none;
  font-size: 0.875rem;
  padding: 0.25rem 0.75rem;
  border: 1px solid var(--bp-border);
  border-radius: 4px;
  transition: background-color 0.2s;
}

.graph-fullpage-link:hover {
  background-color: var(--bp-bg-alt);
  text-decoration: none;
}

/* Graph link card (on homepage) */
.graph-link-card {
  margin: 2rem 0;
}

.graph-card-link {
  text-decoration: none;
  color: inherit;
  display: block;
}

.graph-card {
  display: flex;
  align-items: center;
  padding: 1.5rem;
  background: var(--bp-bg-alt);
  border: 1px solid var(--bp-border);
  border-radius: 8px;
  transition: background-color 0.2s, border-color 0.2s;
}

.graph-card:hover {
  background-color: #f0f4f8;
  border-color: var(--bp-primary);
}

.graph-card-icon {
  flex-shrink: 0;
  width: 64px;
  height: 64px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--bp-primary);
  margin-right: 1.5rem;
}

.graph-card-icon svg {
  width: 48px;
  height: 48px;
}

.graph-card-content {
  flex: 1;
}

.graph-card-content h3 {
  margin: 0 0 0.5rem 0;
  color: var(--bp-text);
  font-size: 1.25rem;
}

.graph-card-content p {
  margin: 0;
  color: var(--bp-text-muted);
  font-size: 0.95rem;
}

.graph-card-arrow {
  flex-shrink: 0;
  font-size: 1.5rem;
  color: var(--bp-primary);
  margin-left: 1rem;
}

/* Graph legend styling */
.graph-legend {
  margin-bottom: 1rem;
  padding: 1rem;
  background: var(--bp-bg-alt);
  border: 1px solid var(--bp-border);
  border-radius: 8px;
}

.graph-legend .title {
  display: flex;
  align-items: center;
  font-weight: bold;
  cursor: pointer;
  margin-bottom: 0.5rem;
}

.graph-legend .btn {
  display: flex;
  flex-direction: column;
  gap: 2px;
  margin-left: 0.5rem;
  padding: 3px;
}

.graph-legend .bar {
  width: 18px;
  height: 2px;
  background: var(--bp-text);
}

.graph-legend dl.legend {
  display: grid;
  grid-template-columns: auto 1fr;
  gap: 0.25rem 1rem;
  margin: 0;
  padding: 0;
  font-size: 0.875rem;
}

.graph-legend dt {
  font-weight: 600;
  color: var(--bp-text);
}

.graph-legend dd {
  margin: 0;
  color: var(--bp-text-muted);
}

/* ========== Dependency Graph Modal Styles ========== */
.dep-modal-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.4);
  z-index: 1000;
  display: flex;
  align-items: center;
  justify-content: center;
}

.dep-modal-content {
  background: white;
  padding: 20px;
  width: 90%;
  max-width: 90vw;
  max-height: 90vh;
  overflow-y: auto;
  border-radius: 8px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  position: relative;
}

.dep-closebtn {
  position: absolute;
  top: 10px;
  right: 15px;
  font-size: 24px;
  cursor: pointer;
  color: #666;
  line-height: 1;
}

.dep-closebtn:hover {
  color: #000;
}

.dep-modal-body {
  padding-top: 10px;
}

.dep-modal-header {
  margin-bottom: 1rem;
  padding-bottom: 0.5rem;
  border-bottom: 1px solid var(--bp-border);
}

.dep-modal-type {
  font-weight: bold;
  color: var(--bp-primary);
}

.dep-modal-label {
  color: var(--bp-text);
}

.dep-modal-links {
  margin-top: 1rem;
}

.dep-modal-links a {
  color: var(--bp-primary);
  text-decoration: none;
  padding: 0.5rem 1rem;
  border: 1px solid var(--bp-border);
  border-radius: 4px;
  display: inline-block;
}

.dep-modal-links a:hover {
  background-color: var(--bp-bg-alt);
}

/* SVG node click styling */
.dep-graph-svg .node {
  cursor: pointer;
}

/* Node hover highlight with smooth transition */
.dep-graph-svg .node ellipse,
.dep-graph-svg .node rect,
.dep-graph-svg .node polygon {
  transition: stroke-width 0.15s ease;
}

.dep-graph-svg .node:hover ellipse,
.dep-graph-svg .node:hover rect,
.dep-graph-svg .node:hover polygon {
  stroke-width: 3px;
}

/* ========== Static HTML Legend and Toolbar ========== */

/* Wrapper for controls + graph - uses grid for side-by-side layout */
.dep-graph-wrapper {
  position: relative;
  width: 100%;
  height: 100%;
  display: grid;
  grid-template-columns: 200px 1fr;
  gap: 0.5rem;
  padding: 0.5rem;
}

/* Combined controls container (legend + toolbar) */
.dep-graph-controls {
  position: static;  /* No longer absolute - grid handles positioning */
  z-index: 20;
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  align-self: start;  /* Align to top of grid cell */
}

/* When toolbar is inside controls, remove its absolute positioning */
.dep-graph-controls .dep-graph-toolbar {
  position: static;
}

/* Compact legend styles */
.dep-graph-legend {
  background: white;
  border: 1px solid #ccc;
  border-radius: 4px;
  padding: 0.5rem;
  font-size: 0.875rem;
  color: #333;
}

.dep-graph-legend .legend-title {
  font-weight: bold;
  margin-bottom: 0.5rem;
}

.dep-graph-legend .legend-items {
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
}

.dep-graph-legend .legend-item {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.dep-graph-legend .legend-swatch {
  width: 16px;
  height: 16px;
  border-radius: 3px;
}

/* 8 Status Colors */
.dep-graph-legend .legend-swatch.not-ready { background-color: #F4A460; }
.dep-graph-legend .legend-swatch.stated { background-color: #FFD700; }
.dep-graph-legend .legend-swatch.ready { background-color: #20B2AA; }
.dep-graph-legend .legend-swatch.sorry { background-color: #8B0000; }
.dep-graph-legend .legend-swatch.proven { background-color: #90EE90; }
.dep-graph-legend .legend-swatch.fully-proven { background-color: #228B22; }
.dep-graph-legend .legend-swatch.mathlib-ready { background-color: #4169E1; }
.dep-graph-legend .legend-swatch.in-mathlib { background-color: #191970; }

/* Legend separator line between colors and shapes */
.dep-graph-legend .legend-separator {
  width: 100%;
  height: 1px;
  background-color: #ccc;
  margin: 0.5rem 0;
}

.dep-graph-legend .legend-shape {
  width: 16px;
  height: 12px;
  border: 1px solid #333;
  background: #f0f0f0;
}

.dep-graph-legend .legend-shape.ellipse {
  border-radius: 50%;
}

.dep-graph-legend .legend-shape.box {
  border-radius: 2px;
}

/* ========== SBS Container in Modal ========== */
/* Ensure sbs-container displays properly in modal */
.dep-modal-content .sbs-container {
  display: flex;
  gap: 1.5rem;
  margin-left: 0;  /* Override the normal 3rem margin */
  margin-bottom: 1rem;
}

.dep-modal-content .sbs-latex-column,
.dep-modal-content .sbs-lean-column {
  flex: 1;
  min-width: 0;  /* Allow shrinking below content size */
}

/* LaTeX proof toggle in modal */
.dep-modal-content .proof_wrapper {
  margin-top: 0.5rem;
}

.dep-modal-content .proof_heading {
  cursor: pointer;
}

/* Lean code max height in modal */
.dep-modal-content .lean-code {
  max-height: 400px;
  overflow-y: auto;
}

/* Modal links section - right-aligned with border */
.dep-modal-content .dep-modal-links {
  margin-top: 1rem;
  padding-top: 0.5rem;
  border-top: 1px solid var(--bp-border, #e0e0e0);
  text-align: right;
}

.dep-modal-content .dep-modal-links a {
  color: var(--bp-link, #0066cc);
  text-decoration: none;
}

.dep-modal-content .dep-modal-links a:hover {
  text-decoration: underline;
}
